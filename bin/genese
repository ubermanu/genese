#!/usr/bin/env php
<?php
if (file_exists(__DIR__ . '/../autoload.php')) {
    require_once __DIR__ . '/../autoload.php';
} elseif (file_exists(__DIR__ . '/../vendor/autoload.php')) {
    require_once __DIR__ . '/../vendor/autoload.php';
} elseif (file_exists(__DIR__ . '/../../../autoload.php')) {
    require_once __DIR__ . '/../../../autoload.php';
}

$app = new \Symfony\Component\Console\Application('genese');
$app->setVersion(\Composer\InstalledVersions::getRootPackage()['pretty_version']);

// Generates a new command for the available generators
foreach (glob('_templates/*/*') as $path) {
    $parts = explode(DIRECTORY_SEPARATOR, $path);
    $command = new \Genese\GeneratorCommand(
        new \Genese\Generator($parts[1], $parts[2]),
        strtolower($parts[1]) . ':' . strtolower($parts[2])
    );
    $app->add($command);
}

$app->run();
